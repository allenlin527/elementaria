# 艾利門特亞遊戲結構設計文檔

## I. 架構概覽

基於前期世界觀設定及技術限制，艾利門特亞遊戲結構設計必須平衡豐富的遊戲體驗與網頁技術效能限制。本文檔提供完整且可實施的遊戲結構框架。

### 整體架構評估

現有的三區域設計（和諧村、元素混亂森林、遺忘神殿）提供了合理的遊戲規模，但需強化以下結構要素：

- **模塊化區域設計**：確保每個區域可獨立開發並動態載入
- **漸進式難度曲線**：從引導式體驗到開放挑戰的平滑過渡
- **多人互動機會**：在關鍵節點設計多人合作環節

### 技術可行性分析

依據技術文檔中的限制，遊戲結構必須支持：

- 初始載入小於300KB的核心引擎
- 按需載入區域內容和資源
- 輕量級多人同步系統
- 無登入的臨時玩家身份管理

## II. 核心遊戲循環設計

### 基礎互動循環

艾利門特亞的核心遊戲循環圍繞「探索-發現-解決-成長」的模式設計：

1. **探索環境**：閱讀場景描述，與NPC對話，發現問題
2. **學習元素知識**：獲取解決特定問題所需的元素知識
3. **應用元素能力**：選擇適當元素能力解決環境或NPC困境
4. **提升元素親和力**：解決問題後獲得相應元素親和力提升
5. **解鎖新區域/任務**：隨著能力成長解鎖更複雜的挑戰

此循環的技術實現重點：
- 核心選擇系統佔用資源小，適合即時載入
- 元素視覺效果可根據設備性能動態調整
- 解決問題的多種方案支持不同玩家風格

### 多人互動循環

在主循環基礎上，設計疊加多人互動循環：

1. **發現協作機會**：特定元素門戶或難題需多元素合作
2. **尋找協作夥伴**：使用情境表情或區域聊天尋找協助
3. **協同施法**：多玩家同時選擇互補元素能力
4. **共享成功**：共同解鎖進展，獲得獨特「元素共鳴」獎勵
5. **社交連結**：建立臨時合作關係，解決後續挑戰

技術實現考量：
- 同步需求集中在特定協作點，減少持續同步壓力
- 臨時ID系統支持無登入的短期協作
- 表情系統提供輕量級溝通方式

## III. 區域結構設計

### 和諧村（起始區域）

對現有設計的結構優化：

**空間佈局**：
```
中央廣場（中樞）
  ├─ 村長住所（主線起點）
  ├─ 元素守護者小屋（教學區）
  ├─ 村民住區（支線任務源）
  └─ 四元素試煉區
      ├─ 火爐區（火元素試煉）
      ├─ 水井區（水元素試煉）
      ├─ 風車區（風元素試煉）
      └─ 農田區（土元素試煉）
```

**進展結構**：
- 線性教學序列引導玩家掌握基本機制
- 完成基礎教學後開放四元素試煉，可自選順序
- 需完成至少兩項試煉才能解鎖通往森林的路徑

**載入策略**：
- 中央廣場與村長住所作為初始載入包（<100KB）
- 玩家選擇主元素後優先載入相應元素試煉區
- 其他區域根據玩家移動方向動態載入

### 元素混亂森林（中期區域）

結構強化建議：

**空間佈局**：
```
森林入口（集結點）
  ├─ 伊莉絲營地（任務中心）
  └─ 四元素區域
      ├─ 焦炭區（火元素失控區）
      ├─ 沼澤區（水元素失控區）
      ├─ 嘯風谷（風元素失控區）
      ├─ 石化林（土元素失控區）
      └─ 中央元素漩渦（匯流點，需四元素協作）
```

**進展結構**：
- 開放式探索，玩家可選擇任意順序訪問四元素區域
- 每區發現元素紊亂線索，需匹配元素能力解決
- 尋找失蹤的洛恩研究員貫穿四個區域，形成連貫性
- 所有區域調查完成後開啟中央元素漩渦，需多人合作

**載入策略**：
- 森林入口與伊莉絲營地為初始森林載入包
- 四元素區域根據玩家選擇分別載入
- 預測算法基於任務進度預載可能前往的下一區域

### 遺忘神殿（終極區域）

結構精細化設計：

**空間佈局**：
```
神殿外域（預備區）
  ├─ 阿薩守衛處（入口試煉）
  ├─ 四元素通道
  │   ├─ 火元素試煉廳
  │   ├─ 水元素試煉廳
  │   ├─ 風元素試煉廳
  │   └─ 土元素試煉廳
  ├─ 元素融合大廳（多人協作區）
  └─ 封印核心（最終對決）
```

**進展結構**：
- 序列式挑戰，需按特定順序通過試煉
- 每個元素試煉廳測試玩家對該元素的掌握程度
- 元素融合大廳要求2-4名不同元素玩家同時在場
- 封印核心對決提供多結局可能性

**載入策略**：
- 神殿外域與阿薩守衛處為初始神殿載入包
- 試煉廳根據玩家進入順序動態載入
- 最終對決場景預先載入，確保關鍵時刻流暢體驗

## IV. 任務系統結構

### 任務類型層級

設計四層任務結構，確保任務體系豐富度與技術可行性平衡：

1. **主線任務**：推動核心故事，必須完成
   - 每區域3-4個關鍵任務
   - 明確的進展指標與獎勵
   - 單人可完成，但某些環節有多人協作選項

2. **元素試煉**：特定元素能力測試
   - 各元素2-3個試煉任務
   - 著重於該元素特性的創造性應用
   - 完成提升相應元素親和力

3. **村民請求**：小型支線任務
   - 每區域5-6個簡短任務
   - 提供世界觀深化與額外獎勵
   - 技術上實現為輕量級對話樹與狀態檢查

4. **隱藏挑戰**：高級玩家內容
   - 需特定條件觸發
   - 提供獨特外觀獎勵
   - 設計為後期動態載入內容

### 任務數據結構

設計輕量級任務數據模型，支持動態載入：

```javascript
const questTemplate = {
    id: "unique_quest_id",              // 任務唯一標識
    title: "Quest Title",               // 顯示名稱
    type: "main|trial|side|hidden",     // 任務類型
    area: "village|forest|temple",      // 所屬區域
    elementAffinity: "fire|water|air|earth|mixed", // 關聯元素
    requiredElements: [],               // 需要的元素類型（多人任務）
    prerequisiteQuests: [],             // 前置任務要求
    stages: [                           // 任務階段
        {
            id: "stage1",
            description: "Stage description text",
            objective: "talk|collect|solve|cooperate", // 目標類型
            targetId: "npc_id|puzzle_id",              // 目標對象
            completionCondition: "function() {return true}" // 完成條件
        }
    ],
    rewards: {
        elementPower: {fire: 0, water: 0, air: 0, earth: 0},
        specialItem: null,
        unlocks: []
    },
    isMultiplayer: false,               // 是否需多人協作
    minPlayers: 1,                      // 最少需要玩家數
}
```

## V. 進展系統設計

### 角色成長架構

設計簡化但有深度的角色成長系統：

**核心屬性**：
- 四元素親和力（火、水、風、土）：影響相應元素法術效果
- 元素調和力：影響組合元素的能力
- 靈感值：解鎖特殊對話選項與隱藏內容

**成長機制**：
- 屬性提升綁定任務完成，避免複雜經驗值計算
- 主元素親和力成長較快，次要元素需額外努力
- 設計成長上限，確保平衡性

**技術實現考量**：
- 角色數據存儲於localStorage，支持臨時存檔
- 狀態變化時即時保存，防止意外關閉損失進度
- 輕量JSON結構，避免存儲過大資料

### 遊戲進度追蹤

設計區域解鎖與進度追蹤系統：

**解鎖機制**：
- 和諧村：初始可訪問
- 元素混亂森林：需完成和諧村主線任務與至少兩個元素試煉
- 遺忘神殿：需解決森林中的元素漩渦危機

**進度指標**：
- 區域探索度：每區域發現的地點百分比
- 任務完成率：各類型任務的完成比例
- 元素掌握度：各元素能力解鎖程度

**多人進度同步**：
- 同區域玩家可看到彼此的角色等級與主元素
- 協作任務狀態對所有參與者同步更新
- 世界事件進度在所有玩家間共享

## VI. 技術實現藍圖

### 模塊化載入策略

根據遊戲結構設計模塊化資源包：

**核心包**（<300KB）：
- 基本UI系統
- 對話與選擇引擎
- 角色數據管理
- 簡化版多人連接系統

**區域資源包**：
- 和諧村包：~150KB（基礎區域）+ 4×50KB（元素區域）
- 森林包：~100KB（入口區）+ 4×80KB（元素區域）
- 神殿包：~120KB（外域區）+ 4×70KB（試煉廳）+ 100KB（最終區）

**載入優先順序**：
1. 核心包（遊戲啟動）
2. 當前區域中心資源
3. 玩家可能前往的相鄰區域
4. 背景載入其他資源

### 多人互動實現

針對遊戲結構設計多人功能實現方案：

**玩家存在感**：
- 同區域玩家顯示為元素顏色光點
- 名稱與主元素圖標懸浮顯示
- 當前行動狀態簡化表示（探索中、對話中、施法中）

**互動機制**：
- 近距離交流：同一詳細位置的玩家可看到彼此的選擇
- 協作施法：特定位置允許多人同時選擇元素，產生組合效果
- 表情系統：8種基本表情，支持簡單非語言溝通

**伺服器負載優化**：
- 將玩家分組到區域實例中，每實例最多支持10名玩家
- 只同步關鍵狀態變化，非持續位置更新
- 使用WebSocket心跳保持連接，但減少數據傳輸

## VII. MVP與擴展路徑

### 最小可行產品範圍

基於8週開發時間，定義MVP核心範圍：

**核心體驗**：
- 完整和諧村區域與主線任務
- 元素混亂森林的入口區與一個元素區域（根據測試反饋選擇）
- 基本多人可見性與表情互動
- 四種基本元素能力（每元素一種）

**技術基礎**：
- 模塊化載入系統完全實現
- 臨時ID與基本多人同步
- 角色數據本地存儲
- 基本CSS元素視覺效果

### 發布後擴展計劃

規劃MVP成功後的階段性擴展：

**階段一**（發布後2週）：
- 完成所有森林元素區域
- 添加額外元素能力（每元素增加1種）
- 強化多人協作系統

**階段二**（發布後1個月）：
- 實現遺忘神殿完整內容
- 添加元素組合效果
- 引入季節性元素失衡事件

**階段三**（發布後3個月）：
- 新增第四區域（元素學院或元素礦脈）
- 實施更複雜的元素融合系統
- 添加自定義角色外觀選項

## VIII. 結論

艾利門特亞的遊戲結構設計平衡了豐富的遊戲體驗與技術限制，通過模塊化區域、漸進式難度曲線和多層次任務系統創造出引人入勝的文字冒險體驗。核心設計確保在技術約束下依然能提供完整且有深度的遊戲內容，同時留下清晰的擴展路徑。

建議開發團隊將本文檔結合先前的世界觀設計，作為開發過程中的核心參考，確保所有功能實現與內容創作保持一致的遊戲體驗方向。